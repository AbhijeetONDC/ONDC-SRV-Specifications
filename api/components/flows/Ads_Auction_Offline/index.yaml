summary: Ads Bids & Auction - Open
description: The following is an illustrative flow to perform a transaction of a nature where a buyer would like to request for Ads services. The booking majorly happens in four phases of order processing flow, i.e. Discovery of available services and service providers based on serviceability, order, fulfillment and post-fulfillment.
details:
  - description: Sequence Diagram for Bids and Auction
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant G as Gateway
        participant SA1 as SellerApp1
        participant SA2 as SellerApp2
        
        Note Over B,SA2: **SEARCH FLOW**
        B ->> BA: Buyer initiates an exploratory search for Bids and Auctions.
        BA ->> G: **/search** - Search by city for a commodity and <br>additional parameters
        G ->> SA1: **/search** - Commodity bids request broadcasted based <br>on city and domain in context
        G ->> SA2: **/search** - Commodity bids request broadcasted based <br>on city and domain in context
        SA1 ->> BA: **/on_search** - Seller responds with /on_search, providing available auctions <br> with their details, including floor price, Start/End Time, Bid Increment
        SA2 ->> BA: **/on_search** - Seller responds with /on_search, providing available auctions <br> with their details, including floor price, Start/End Time, Bid Increment
        Note Over BA,SA1: Buyer now has the option to choose the <br>Commodity bids from either Seller 1 or Seller 2 or both
        BA ->> B: Shows all the avilable bids <br>options from sellers

  - description: Auction Selection
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant SA as SellerApp
        Note Over B,SA: **SELECT FLOW**
        B ->> BA: Buyer selects an auction.
        BA ->> SA: **/select** - Buyer sends a /select request to <br> Seller, along with the Buyer's ID.
        SA ->> SA: Verifies Buyer ID
        SA ->> BA: **/on_select** - Seller verifies the Buyer's ID <br> whether he is allowed or not and send the status.
        BA ->> B: If Buyer is eligible, Seller confirms bid details

  - description: Fee Requirement Check
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant SA as SellerApp
        Note Over B,SA: **FEE REQUIREMENT CHECK**
        B ->> BA: If a fee is required, buyer check payment
        BA ->> SA: **/init** - Buyer requests participation with /init
        SA ->> BA: **/on_init** - Seller responds with /on_init, <br> sending a payment gateway (PG) link for payment.
        B ->> BA: Buyer makes the payment.

  - description: Bid Placement
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant SA as SellerApp
        Note Over B,SA: **BID PLACEMENT FLOW**
        B ->> BA: Buyer places a bid.
        BA ->> SA: **/init** - Buyer sends /init, indicating bid placement. <br> The bid price will be shared in the intent.
        SA ->> BA: **/on_init** - Seller acknowledges the bid placement with /on_init.
        BA ->> B: Confirms Bid Placement

  - description: Bid Confirmation
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant SA as SellerApp
        Note Over B,SA: **CONFIRMATION FLOW**
        B ->> BA: Confirms the Order
        BA ->> SA: **/confirm** - Buyer confirms the order
        SA ->> BA: **/on_confirm** - Seller responds with /on_confirm, <br> creating an Order ID with the bid state set to "Placed."
        BA ->> B: Confirms the bids

  - description: Fulfillment
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant SA as SellerApp 
        Note Over B,SA: **BIDS STATUS FLOW**
        B ->> BA: Checks the bid status
        BA ->> SA: **/status** - Enquire bid status <br>or maximum bid price (if open bid)
        SA ->> BA: **/on_status** - Seller responds with the highest price
        BA ->> B: Updates the latest status

  - description: Update Requests
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant SA as SellerApp 
        Note Over B,SA: **BIDS UPDATES FLOW**
        B ->> BA: Buyer requests updates with /update
        BA ->> SA: **/update** - Buyer requests updates
        SA ->> BA: **/on_update** - Seller responds with /on_update, updating with the highest price
        BA ->> B: Updates the latest status
        B ->> BA: Buyer may update an existing bid price with another /update request.

  - description: Bid Outcome
    mermaidGraph: >-
      sequenceDiagram
        participant B as Buyer
        participant BA as BuyerApp
        participant SA as SellerApp 
        Note Over B,SA: **BID OUTCOME FLOW**
        B ->> BA: Buyer requests an update on the auction
        BA ->> SA: **/update** - Buyer requests an update on the auction
        SA ->> BA: **/on_update** - If Buyer wins the bid, Seller responds with /on_update,<br> setting the bid state to "Awarded."
        SA ->> BA: **/on_update** - If Buyer loses, Seller responds with /on_update, <br> setting the bid state to "Not Awarded" and indicating the highest bid amount.
        BA ->> B: Updates the latest bid outcome

reference: if any
steps:
  - summary: Search based on the intent for buying Ads service
    api: search
    description: Search intent sent by the buyer based on the particular Ads service required
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/search/search_by_category.yaml"
  - summary: Returns the catalog specific to the search intent
    api: on_search
    description: Returns the catalog specific to the search intent
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_search/on_search_auction.yaml"
  - summary: Buyer selects the required Ads service
    api: select (Eligbility check)
    description: Buyer selects the required Ads service with bidding fulfillment and elgible pre-decided ID
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/select/select_auction.yaml"
  - summary: Seller confirms the schedule and returns the quote for service
    api: on_select (Eligbility check)
    description: Seller confirms the requests and deposit payment quote
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_select/on_select_auction.yaml"
  - summary: Buyer initialises the order for service
    api: init (Participant fee intiation)
    description: Buyer initialises the order and provides billing details
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/init/init_auction.yaml"
  - summary: Seller provides the final quotation for the service
    api: on_init (Participant fee payment url link)
    description: Seller provides the final quotation
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_init/on_init_auction.yaml"
  - summary: Seller provides the final quotation for the service
    api: on_status (Payment confirmation)
    description: Seller provides the confirmation of the payment
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_status/on_status_auction_confirm_deposit.yaml"
  - summary: Buyer initialises the order for service
    api: init (Bid placement)
    description: Buyer initialises the order and provides billing details
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/init/init_auction_bid.yaml"
  - summary: Seller provides the final quotation for the service
    api: on_init (Bid placement confirmation)
    description: Seller provides the final quotation
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_init/on_init_auction_bid.yaml"
  - summary: Buyer confirms the order
    api: confirm (Confirm Bid Order)
    description: Buyer confirms the order
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/confirm/confirm_auction.yaml"
  - summary: Seller accepts the order
    api: on_confirm (Confirm Bid Order & Placement)
    description: Seller accepts the order
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_confirm/on_confirm_auction.yaml"
  - summary: Buyer requests for status
    api: status
    description: Buyer requests for status with order id
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/status/status.yaml"
  - summary: Seller sends the highest bid back
    api: on_status
    description: Seller send the bid order details and the highest bid at the moment
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_status/on_status_auction.yaml"
  - summary: Buyer updates bid
    api: update (Update bid)
    description: Buyer request to update the bid amount
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/update/update_auction.yaml"
  - summary: Seller accepts the bid increment
    api: on_update (Bid increment confirm)
    description: Seller accepts the bid increment and sends a new payment object with updated quote
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_update/on_update_auction.yaml"
  - summary: Seller awards the bid
    api: on_update (Awarded)
    description: Seller sends update back with status changed to AWARDED
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_update/on_update_awarded.yaml"
  - summary: Seller sends not awarded
    api: on_update (Not Awarded)
    description: Seller sends update back with status changed to NOT_AWARDED and cancels order
    reference: if any
    example:
      $ref: "../../Examples/Ads_services_yaml/on_update/on_update_not_awarded.yaml"
